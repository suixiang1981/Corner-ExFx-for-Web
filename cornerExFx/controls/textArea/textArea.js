var __extends=this&&this.__extends||function(){var l=function(e,t){l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return l(e,t)};return function(e,t){l(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();define(["require","exports","../../core/util","../../core/displayObject","../scroller/scroller","../../core/fXEvent"],function(e,t,l,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(e){__extends(r,e);function r(){var t=e.call(this)||this;t._multiLine=false;t._wordWrap=true;t.k=12;t.vScroller=new i.Scroller(true);t.hScroller=new i.Scroller(false);t.t=-1;t._myTimeHaneld=-1;if(!r.isCSSLoaded){Loader.loadCSS("cornerExFx/controls/textArea/skins/"+l.Util.skin+"/textArea.css");r.isCSSLoaded=true}t._element.innerHTML=Loader.loadTXT("cornerExFx/controls/textArea/skins/"+l.Util.skin+"/textArea.html",true);t._textAreaElement=l.Util.getElementByClass("textarea",t._element);t.divPanel=l.Util.getElementByClass("textareaPanel",t._element);t.wordWrap=t._wordWrap;t.vScroller.width=16;t.vScroller.top=0;t.vScroller.bottom=0;t.vScroller.right=0;t.vScroller.addEventListener(o.FXScrollEvent.Scroll,function(e){t._textAreaElement.scrollTop=t.vScroller.value*t.k});t.hScroller.height=16;t.hScroller.left=0;t.hScroller.bottom=0;t.hScroller.right=0;t.hScroller.addEventListener(o.FXScrollEvent.Scroll,function(e){t._textAreaElement.scrollLeft=e.value*t.k});t._textAreaElement.addEventListener("input",function(e){t._value=t._textAreaElement.value;t.refresh()});t._textAreaElement.onscroll=function(e){t.vScroller.value=t._textAreaElement.scrollTop/t.k;t.hScroller.value=t._textAreaElement.scrollLeft/t.k};l.Util.appendDisplayObject(t._element,t.vScroller);l.Util.appendDisplayObject(t._element,t.hScroller);t._textAreaElement.addEventListener("wheel",function(e){if(e.deltaY>0){t._textAreaElement.scrollTop+=t.k}else{t._textAreaElement.scrollTop-=t.k}});t._textAreaElement.addEventListener("keydown",function(e){if(e.keyCode==13&&!t._multiLine){e.preventDefault()}});return t}Object.defineProperty(r.prototype,"multiLine",{get:function(){return this._multiLine},set:function(e){this._multiLine=e},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap=e;if(this._wordWrap){this._textAreaElement.style.whiteSpace="pre-wrap"}else{this._textAreaElement.style.whiteSpace="nowrap"}},enumerable:true,configurable:true});r.prototype.r=function(){var e=this;this.t=setInterval(function(){if(e._textAreaElement.clientWidth>0){e.refresh();clearInterval(e.t)}},1)};r.prototype.refresh=function(){var e=this;if(this._myTimeHaneld==-1){this._myTimeHaneld=setInterval(function(){clearInterval(e._myTimeHaneld);e._myTimeHaneld=-1;e.refreshFunction()},1)}};r.prototype.refreshFunction=function(){var e=this;this.vScroller.count=this._textAreaElement.scrollHeight/this.k;this.vScroller.pageCount=this._textAreaElement.clientHeight/this.k;if(!this._wordWrap){this.hScroller.count=this._textAreaElement.scrollWidth/this.k;this.hScroller.pageCount=this._textAreaElement.clientWidth/this.k;if(this.vScroller.pageCount<this.vScroller.count){if(this.hScroller.right<16){this.hScroller.right=16;this.divPanel.style.right="18px";setTimeout(function(){e.hScroller.count=e._textAreaElement.scrollWidth/e.k},1)}}else{if(this.hScroller.right>0){this.hScroller.right=0;this.divPanel.style.right="2px";setTimeout(function(){e.hScroller.count=e._textAreaElement.scrollWidth/e.k},1)}}}else{this.hScroller.visible=false;this.hScroller.count=1;this.hScroller.pageCount=10;if(this.vScroller.pageCount<this.vScroller.count){if(this.hScroller.right<16){this.hScroller.right=16;this.divPanel.style.right="18px"}}else{if(this.hScroller.right>0){this.hScroller.right=0;this.divPanel.style.right="2px"}}}if(this.hScroller.pageCount<this.hScroller.count){if(this.vScroller.bottom<16){this.vScroller.bottom=16;this.divPanel.style.bottom="18px";setTimeout(function(){e.vScroller.count=e._textAreaElement.scrollHeight/e.k},1)}}else{if(this.vScroller.bottom>0){this.vScroller.bottom=0;this.divPanel.style.bottom="2px";setTimeout(function(){e.vScroller.count=e._textAreaElement.scrollHeight/e.k},1)}}};Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(e){this._textAreaElement.value=e;this._value=e;this.r()},enumerable:true,configurable:true});r.isCSSLoaded=false;return r}(r.DisplayObject);t.TextArea=n});