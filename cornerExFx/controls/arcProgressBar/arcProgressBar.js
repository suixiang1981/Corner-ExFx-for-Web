var __extends=this&&this.__extends||function(){var r=function(e,t){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return r(e,t)};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();define(["require","exports","../../core/displayObject","../../core/util","../../core/drawing"],function(e,t,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e.isCSSReaded=false;e._myTimeHaneld=-1;e._marqueeHandler=-1;e._value=0;e._label="请稍候...";e.element.innerHTML=Loader.loadTXT("cornerExFx/controls/arcProgressBar/skins/"+r.Util.skin+"/arcProgressBar.html",true);e.canvas=r.Util.getElementByClass("arcProgressBarCanvas",e.element);e.progressLabelDIV=r.Util.getElementByClass("arcProgressBarProgressLabel",e.element);e.progressBodyDIV=r.Util.getElementByClass("arcProgressBarBody",e.element);e.labelDIV=r.Util.getElementByClass("arcProgressBarLabel",e.element);e.labelNumSpan=r.Util.getElementByClass("arcProgressBarFontBig",e.element);e.dialBackgroundColor=r.Util.getElementStringAttribute(e.progressBodyDIV,"dialBodyColor");e.dialBarBackgroundColor=r.Util.getElementStringAttribute(e.progressBodyDIV,"dialScaleBackgroundColor");e.dialBarColor=r.Util.getElementStringAttribute(e.progressBodyDIV,"dialScaleColor");e.ctx=e.canvas.getContext("2d");e.refresh();return e}e.prototype.refresh=function(){var e=this;if(this._myTimeHaneld==-1){this._myTimeHaneld=setInterval(function(){clearInterval(e._myTimeHaneld);e._myTimeHaneld=-1;e.refreshFunction()},1)}};e.prototype.refreshFunction=function(){this.canvas.style.width=this.element.offsetWidth*2+"px";this.canvas.style.height=this.element.offsetHeight*2+"px";this.canvas.width=this.element.offsetWidth*2;this.canvas.height=this.element.offsetHeight*2;var e=this.canvas.width/2;var t=this.canvas.height/2;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.fillStyle=this.dialBackgroundColor;s.Drawing.drawHollowArc(this.ctx,e,t,0,2*Math.PI,this.canvas.width/2,0);this.ctx.fill();this.ctx.fillStyle=this.dialBarBackgroundColor;s.Drawing.drawHollowArc(this.ctx,e,t,0,2*Math.PI,this.canvas.width/2-2,this.canvas.width*.47);this.ctx.fill();this.ctx.fillStyle=this.dialBarColor;if(this._marquee){s.Drawing.drawHollowArc(this.ctx,e,t,(-.2+2*this.value/100)*Math.PI,(-.5+2*this.value/100)*Math.PI,this.canvas.width/2-2,this.canvas.width*.47);this.labelNumSpan.textContent="0";this.progressLabelDIV.style.visibility="hidden";this.labelDIV.className="arcProgressBarLabelMiddle"}else{s.Drawing.drawHollowArc(this.ctx,e,t,-Math.PI/2,(-.5+2*this.value/100)*Math.PI,this.canvas.width/2-2,this.canvas.width*.47);this.labelNumSpan.textContent=Math.ceil(this._value).toString();this.progressLabelDIV.style.visibility="visible";this.labelDIV.className="arcProgressBarLabel"}this.ctx.fill();this.canvas.style.width=this.element.offsetWidth+"px";this.canvas.style.height=this.element.offsetHeight+"px"};Object.defineProperty(e.prototype,"marquee",{get:function(){return this._marquee},set:function(e){var t=this;this._marquee=e;if(this._marquee){if(this._marqueeHandler!=-1){clearInterval(this._marqueeHandler);this._marqueeHandler=-1}this._marqueeHandler=setInterval(function(){t.value++;if(t.value>100)t.value=1},50)}else{if(this._marqueeHandler!=-1){clearInterval(this._marqueeHandler);this._marqueeHandler=-1}}this.refreshFunction()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e;this.element.style.visibility=this._visible?"":"hidden";this.element.style.display=this._visible?"":"none";r.Util.htmlElementToTop(this.element);if(!this._visible){this.marquee=false}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){if(this._value!=e){this._value=e;this.refresh()}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(e){this._label=e;this.labelDIV.textContent=this._label;this.refresh()},enumerable:true,configurable:true});return e}(i.DisplayObject);t.ArcProgressBar=a});