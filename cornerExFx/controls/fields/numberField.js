var __extends=this&&this.__extends||function(){var n=function(e,t){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();define(["require","exports","./fieldBase","../../core/util"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(e){__extends(i,e);function i(){var t=e.call(this)||this;t.stepSize=.1;t.decimals=1;t._timerHandle=-1;t._maxValue=Number.MAX_VALUE;t._minValue=0;t._unit="";if(!i.isNumberFieldCSSLoaded){i.isNumberFieldCSSLoaded=true;Loader.loadCSS("cornerExFx/controls/fields/skins/"+n.Util.skin+"/numberField.css")}t.input.oninput=function(e){t.verify()};t.input.onblur=function(e){t.setInputValue();t.verify()};t.element.onkeydown=function(e){if(e.keyCode==40){t.down()}else if(e.keyCode==38){t.up()}};t.element.tabIndex=0;return t}i.prototype.loadHTML=function(){var t=this;this.element.innerHTML=Loader.loadTXT("cornerExFx/controls/fields/skins/air/numberField.html",true);this.fieldNumberUpDiv=n.Util.getElementByClass("fieldNumberUpDiv",this.element);this.fieldNumberDownDiv=n.Util.getElementByClass("fieldNumberDownDiv",this.element);this.fieldNumberUnitDiv=n.Util.getElementByClass("fieldNumberUnitDiv",this.element);this.fieldNumberDownDiv.onpointerup=function(){t.clearTimer()};this.fieldNumberUpDiv.onpointerup=function(){t.clearTimer()};document.addEventListener("pointerup",function(){t.clearTimer()});this.fieldNumberDownDiv.onpointerdown=function(e){e.cancelBubble=true;t.upOrDown(false)};this.fieldNumberUpDiv.onpointerdown=function(e){e.cancelBubble=true;t.upOrDown()}};i.prototype.upOrDown=function(e){var t=this;if(e===void 0){e=true}this.clearTimer();this._timerHandle=setTimeout(function(){e?t.up():t.down();clearTimeout(t._timerHandle);t._timerHandle=setInterval(function(){e?t.up():t.down()},60)},300);e?this.up():this.down()};i.prototype.clearTimer=function(){if(this._timerHandle!=-1){clearInterval(this._timerHandle);this._timerHandle=-1}};i.prototype.up=function(){this.value+=this.stepSize;if(this.value>this._maxValue)this.value=this._maxValue};i.prototype.down=function(){this.value-=this.stepSize;if(this.value<this._minValue)this.value=this._minValue};i.prototype.verify=function(){var e=n.Util.stringToNumber(this.input.value,this.decimals);if(e==null){this.verified=false;this.input.title="请输入正确的数字。"}else if(e>this.maxValue){this.verified=false;this.input.title="请输入小于"+this._maxValue+"的数字。"}else if(e<this.minValue){this.verified=false;this.input.title="请输入大于"+this._minValue+"的数字。"}else{this.verified=true;this.input.title=""}this._value=e;this.setXMLValue()};i.prototype.valueStringToValue=function(){this._value=n.Util.stringToNumber(this.valueString,this.decimals)};i.prototype.valueToValueString=function(){this.valueString=n.Util.numberToString(this._value,this.decimals)};Object.defineProperty(i.prototype,"maxValue",{get:function(){return this._maxValue},set:function(e){this._maxValue=e},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"minValue",{get:function(){return this._minValue},set:function(e){this._minValue=e},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"unit",{get:function(){return this._unit},set:function(e){this._unit=e;this.fieldNumberUnitDiv.textContent=this._unit},enumerable:true,configurable:true});Object.defineProperty(i.prototype,"enabled",{set:function(e){this._enabled=e;if(this._enabled){this.fieldNumberUpDiv.style.visibility="visible";this.fieldNumberDownDiv.style.visibility="visible";this.input["disabled"]=false;this.input.style.color="#000000";this.labelDiv.style.color="#000000"}else{this.input["disabled"]=true;this.input.style.color="#666666";this.labelDiv.style.color="#666666";this.fieldNumberUpDiv.style.visibility="visible";this.fieldNumberDownDiv.style.visibility="visible"}},enumerable:true,configurable:true});i.isNumberFieldCSSLoaded=false;return i}(i.FieldBase);t.NumberField=r});