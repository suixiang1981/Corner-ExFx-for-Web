var __extends=this&&this.__extends||function(){var n=function(e,t){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();define(["require","exports","../../core/displayObject","../../core/arrayCollection","../../core/util","../../core/fXEvent"],function(e,t,i,n,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e._allItems=new n.ArrayCollection;e._labelField="label";e._iconField="icon";e._idField="id";e._dataFieldList=[];e.idFieldIndex=0;e.addItemArray=[];e.removeItemArray=[];e.changeTimer=-1;e._selectedItem=null;return e}e.prototype.getFieldValue=function(e,t){if(e==this.labelField){return t.label}else{for(var i=0;i<this.dataFields.length;i++){if(this.dataFields[i]==e){return t.data[i]}}}return null};Object.defineProperty(e.prototype,"labelField",{get:function(){return this._labelField},set:function(e){this._labelField=e;this.getIdFieldIndex()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iconField",{get:function(){return this._iconField},set:function(e){this._iconField=e;this.getIdFieldIndex()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"idField",{get:function(){return this._idField},set:function(e){this._idField=e;this.getIdFieldIndex()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataFields",{get:function(){return this._dataFieldList},set:function(e){this._dataFieldList=e;this.getIdFieldIndex()},enumerable:true,configurable:true});e.prototype.getIdFieldIndex=function(){if(this._idField==null||this._idField==undefined&&this._idField!=""){this.idFieldIndex=null}else if(this._idField==this._labelField){this.idFieldIndex=-2}else if(this._idField==this._iconField){this.idFieldIndex=-1}else{this.idFieldIndex=this._dataFieldList.indexOf(this._idField);if(this.idFieldIndex==-1){this.idFieldIndex=null}}};e.prototype.xmlDataProviderToListItemData=function(e){var t=new a(l.Util.getElementStringAttribute(e,this.labelField,""),l.Util.getElementStringAttribute(e,this.iconField,""),[]);for(var i=0;i<this.dataFields.length;i++){t.data.push(l.Util.getElementStringAttribute(e,this.dataFields[i],""))}if(this.iconFunction!=null){t.icon=this.iconFunction(t)}if(this.labelFunction!=null){t.label=this.labelFunction(t)}return t};e.prototype.setItemsData=function(e,t){var i=t.count;for(var n=e.length;n<i;n++){t.removeItemAt(t.count-1)}i=e.length;for(var n=0;n<i;n++){if(n<t.count){this.setItemData(e[n],t.getItemAt(n))}else{this.addItemByData(e[n],t,n)}}};e.prototype.setItemXmlDataProvider=function(e,t){var i=this.xmlDataProviderToListItemData(e);this.setItemData(i,t)};e.prototype.getAmendData=function(e){return new a(this.labelFunction!=null?this.labelFunction(e):e.label,this.iconFunction!=null?this.iconFunction(e):e.icon,e.data)};e.prototype.setItemData=function(e,t){e=this.getAmendData(e);t.icon=e.icon;t.label=e.label;t.data=e.data;if("_setSubItems"in t)t["_setSubItems"]()};e.prototype.setItemsXmlDataProvider=function(e,t){var i=[];for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes.item(n);if(r.nodeType==1){var l=r;i.push(this.xmlDataProviderToListItemData(l))}}this.setItemsData(i,t)};e.prototype.addItemByXmlDataProvider=function(e,t,i){if(t===void 0){t=this.items}if(i===void 0){i=-1}return this.addItemByData(this.xmlDataProviderToListItemData(e),t,i)};e.prototype.addItemByData=function(e,t,i){if(t===void 0){t=this.items}if(i===void 0){i=-1}var n;n=this.createListItem(e);t.addItem(n);return n};e.prototype.createListItem=function(e){return null};e.prototype.getIdByItem=function(e){return this.getIdByData(e)};e.prototype.getIdByXmlDataProvider=function(e){return this.getIdByData(this.xmlDataProviderToListItemData(e))};e.prototype.getIdByData=function(e){if(this.idFieldIndex==-2){return e.label}else if(this.idFieldIndex==-1){return e.icon}else{if(e.data.length>this.idFieldIndex){return e.data[this.idFieldIndex]}else{return""}}};e.prototype.getItemById=function(e,t){if(t===void 0){t=null}if(t==null)t=this.items;var i=String(e);var n=t.toArray();for(var r=0;r<n.length;r++){var l=n[r];if(this.getIdByItem(l)==i){return l}}return null};e.prototype.setItems=function(e){var r=this;e.removeAllEventListener(o.FXCollectionEvent.Change);e.addEventListener(o.FXCollectionEvent.Change,function(e){var t=false;if(e.kind==o.CollectionEventKind.Add){var i=e.location;var n=e.items[i];if("parent"in n){if(n["parent"]==null){t=true}}else{t=true}if(e.location==e.items.length-1){l.Util.appendElement(r.itemsPanel,n.element)}else if(i>0){l.Util.insertElement(n.element,e.items[i-1].element,true)}else{if(e.items.length==1){l.Util.appendElement(r.itemsPanel,n.element)}else{l.Util.insertElement(n.element,e.items[1].element,false)}}n.addEventListener(o.FXMouseEvent.MouseDown,function(e){r.item_mouseDown(e)});r.addItemArray.push(n)}else if(e.kind==o.CollectionEventKind.Remove){var i=e.oldLocation;var n=e.items[i];r.removeItemHandler(n)}else if(e.kind==o.CollectionEventKind.RemoveAll){for(var i=0;i<e.items.length;i++){var n=e.items[i];r.removeItemHandler(n)}}if(!t){if(r.changeTimer==-1){r.changeTimer=setTimeout(function(){r.changeTimer=-1;r.itemsPanel.style.visibility="hidden";r.changeHandler();r.itemsPanel.style.visibility="visible"},1)}}})};e.prototype.removeItemHandler=function(e){e.removeAllEventListener(o.FXMouseEvent.MouseDown);l.Util.removeElement(e.element.parentElement,e.element)};e.prototype.changeHandler=function(){};Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._selectedItem},set:function(e){this.selectItem(this._allItems,e)},enumerable:true,configurable:true});e.prototype.selectItem=function(e,t){};e.prototype.item_mouseDown=function(e){this.selectedItem=e.target};Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:true,configurable:true});return e}(i.DisplayObject);t.ListBase=r;var a=function(){function e(e,t,i){if(t===void 0){t=""}if(i===void 0){i=[]}this.label=e;this.icon=t;this.data=i}return e}();t.ListItemData=a});