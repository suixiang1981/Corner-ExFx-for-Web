var __extends=this&&this.__extends||function(){var n=function(e,t){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)if(t.hasOwnProperty(o))e[o]=t[o]};return n(e,t)};return function(e,t){n(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}();define(["require","exports","../../core/displayObject","../../core/util","../listBox/listBase","../../core/fXEvent","../../core/arrayCollection","../handle/handle"],function(e,t,o,a,n,r,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=function(e){__extends(t,e);function t(){var n=e.call(this)||this;n.handle=new l.Handle;n.isCSSLoaded=false;n.w=1e3;n.h=1e3;n.oldw=1e3;n.oldh=1e3;n.cx=0;n.cy=0;n.x=0;n.y=0;n.r=0;n.groupItemArr=new Array;n._items=new i.ArrayCollection;n.panel=document.createElement("div");n.zoomNumber=1;n.colorField="color";n.backgroundColorField="backgroundColor";if(!n.isCSSLoaded){n.isCSSLoaded=true;Loader.loadCSS("cornerExFx/controls/group/skins/"+a.Util.skin+"/group.css")}n.element.className="groupBody";n.panel.className="groupPanel";n.panel.style.visibility="hidden";a.Util.appendDisplayObject(n.element,n.handle);a.Util.appendElement(n.element,n.panel);n.handle.addEventListener(l.FXMoveEvent.MoveStart,function(e){n.x=n.panel.offsetLeft;n.y=n.panel.offsetTop});n.handle.addEventListener(l.FXMoveEvent.Move,function(e){n.panel.style.left=n.x+e.x+"px";n.panel.style.top=n.y+e.y+"px"});n.handle.addEventListener(l.FXMoveEvent.MoveEnd,function(e){n.x=n.panel.offsetLeft;n.y=n.panel.offsetTop});n.element.onmousewheel=function(e){if(e.wheelDelta!=0){n.zoom(e.wheelDelta/40)}else if(e.detail!=0){n.zoom(e.detail)}};setTimeout(function(){var e=n.element.clientWidth;var t=n.element.clientHeight;n.w=Math.min(e,t);n.h=Math.min(e,t);n.r=n.w/2.5;n.x=(e-n.w)/2;n.y=(t-n.h)/2;n.cx=n.w/2;n.cy=n.h/2;n.panel.style.left=n.x+"px";n.panel.style.top=n.y+"px";n.oldh=n.h;n.oldw=n.w;n.handle.percentWidth=100;n.handle.percentHeight=100;n.panel.style.visibility="visible"},1);n._items.addEventListener(r.FXCollectionEvent.Change,function(e){for(var t=0;t<n.groupItemArr.length;t++){var o=n.groupItemArr[t];if(e.items.indexOf(o)==-1){a.Util.removeDislayObject(n.panel,o)}}for(var t=0;t<e.items.length;t++){var o=e.items[t];if(n.groupItemArr.indexOf(o)==-1){n.groupItemArr.push(o)}a.Util.appendDisplayObject(n.panel,o)}n.setGroupItems()});return n}Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:true,configurable:true});t.prototype.setGroupItems=function(){for(var e=0;e<this.groupItemArr.length;e++){var t=this.groupItemArr[e];var o=Math.PI*2/this.groupItemArr.length*e;var n=this.r;t.left=(this.cx+Math.sin(o)*n)*this.zoomNumber;t.top=(this.cy+Math.cos(o)*n)*this.zoomNumber}};t.prototype.zoom=function(e){this.zoomNumber=this.zoomNumber*(1+e/30);var t=this.w*this.zoomNumber;var o=this.h*this.zoomNumber;this.x=this.x-(t-this.oldw)/2;this.y=this.y-(o-this.oldh)/2;this.oldw=t;this.oldh=o;this.panel.style.left=this.x+"px";this.panel.style.top=this.y+"px";this.setGroupItems()};Object.defineProperty(t.prototype,"xmlDataProvider",{set:function(e){this._xmlDataProviderElement=e;this.setItemsXmlDataProvider(this._xmlDataProviderElement,this.items)},enumerable:true,configurable:true});t.prototype.createListItem=function(e){var t=e.icon;var o=e.label;var n=e.color;if(this.iconFunction!=null){t=this.iconFunction(e)}if(this.labelFunction!=null){o=this.labelFunction(e)}return new c(o,t,n,e.backgroundColor,e.data)};t.prototype.xmlDataProviderToListItemData=function(e){var t=new u(a.Util.getElementStringAttribute(e,this.labelField,""),a.Util.getElementStringAttribute(e,this.iconField,""),[]);t.color=a.Util.getElementStringAttribute(e,this.colorField,"");t.backgroundColor=a.Util.getElementStringAttribute(e,this.backgroundColorField,"");t.color=a.Util.getElementStringAttribute(e,this.colorField,"");for(var o=0;o<this.dataFields.length;o++){t.data.push(a.Util.getElementStringAttribute(e,this.dataFields[o],""))}if(this.iconFunction!=null){t.icon=this.iconFunction(t)}if(this.labelFunction!=null){t.label=this.labelFunction(t)}return t};return t}(n.ListBase);t.GroupPanel=s;var u=function(t){__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.color="";e.backgroundColor="";e.image="";return e}return e}(n.ListItemData);t.GroupData=u;var c=function(l){__extends(s,l);function s(e,t,o,n,r){if(t===void 0){t=null}if(o===void 0){o=null}if(n===void 0){n=null}if(r===void 0){r=[]}var i=l.call(this)||this;i._data=[];i._icon="";i._label="";i._color="";i._backgroundColor="";if(!s.isCSSLoaded){s.isCSSLoaded=true;Loader.loadCSS("cornerExFx/controls/group/skins/"+a.Util.skin+"/groupItem.css")}i.element.innerHTML=Loader.loadTXT("cornerExFx/controls/group/skins/groupItem.html",true);i.groupItemIcon=a.Util.getElementByClass("groupItemIcon",i.element);i.groupItemLabel=a.Util.getElementByClass("groupItemLabel",i.element);i.label=e;i.icon=t;i.data=r;i.color=o;i.backgroundColor=n;i.element.className="groupItem";return i}Object.defineProperty(s.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:true,configurable:true});Object.defineProperty(s.prototype,"icon",{get:function(){return this._icon},set:function(e){this._icon=e;if(this._icon==null||this._icon==""){this.groupItemIcon.src="";this.groupItemIcon.style.visibility="hidden"}else{this.groupItemIcon.src=this._icon;this.groupItemIcon.style.visibility="visible"}},enumerable:true,configurable:true});Object.defineProperty(s.prototype,"label",{get:function(){return this._label},set:function(e){this._label=e;this.groupItemLabel.textContent=e},enumerable:true,configurable:true});Object.defineProperty(s.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e;this.groupItemLabel.style.color=e},enumerable:true,configurable:true});Object.defineProperty(s.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e;this.element.style.backgroundColor=e},enumerable:true,configurable:true});s.size=100;s.isCSSLoaded=false;return s}(o.DisplayObject);t.GroupItem=c});