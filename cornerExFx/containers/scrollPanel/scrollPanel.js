var __extends=this&&this.__extends||function(){var r=function(l,e){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,e){l.__proto__=e}||function(l,e){for(var t in e)if(e.hasOwnProperty(t))l[t]=e[t]};return r(l,e)};return function(l,e){r(l,e);function t(){this.constructor=l}l.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}();define(["require","exports","../../controls/scroller/scroller","../../core/fXEvent","../../core/util","../panel/panel"],function(l,e,o,n,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=function(e){__extends(r,e);function r(l){if(l===void 0){l=false}var t=e.call(this)||this;t.timerHandler=-1;t._myTimeHaneld=-1;t.refreshCancel=false;t._lineHeight=30;t._isHScroll=true;t._isVScroll=true;t.isDark=l;if(!r.isCSSLoaded){r.isCSSLoaded=true;Loader.loadCSS("cornerExFx/containers/scrollPanel/skins/"+s.Util.skin+"/scrollPanel.css")}t.element.innerHTML=Loader.loadTXT("cornerExFx/containers/scrollPanel/skins/scrollPanel.html",true);t.scrollPanel=s.Util.getElementByClass("scrollPanel",t.element);t._panel=s.Util.getElementByClass("scrollInternalPanel",t.element);if(l){t.scrollPanel.className="scrollPanelDark"}t.timerHandler=setInterval(function(){if(t.refreshCancel){return}if(t.pH!=t.scrollPanel.clientHeight||t.pW!=t.scrollPanel.clientWidth||t.ipH!=t._panel.clientHeight||t.ipW!=t._panel.clientWidth){var l=new n.FXResizeEvent;l.clientWidth=t.scrollPanel.clientWidth;l.clientHeight=t.scrollPanel.clientHeight;l.scrollWidth=t._panel.clientWidth;l.scrollHeight=t._panel.clientHeight;l.oldClientWidth=t.pW;l.oldClientHeight=t.pH;l.oldScrollWidth=t.ipW;l.oldScrollHeight=t.ipH;l.target=t;l.type=n.FXResizeEvent.Resize;t.pH=t.scrollPanel.clientHeight;t.pW=t.scrollPanel.clientWidth;t.ipH=t._panel.clientHeight;t.ipW=t._panel.clientWidth;t.refreshFunction();t.dispatchEvent(l)}},100);t.scrollPanel.addEventListener("wheel",function(l){if(t.refreshCancel){return}var e=false;if(t._isVScroll){if(t._vScroller!=null){if(t._vScroller.pageCount<t._vScroller.count){e=true;if(l.deltaY>0){t.scrollPanel.scrollTop+=t._lineHeight}else{t.scrollPanel.scrollTop-=t._lineHeight}}}}if(!e){if(t._isHScroll){if(t._hScroller!=null){if(t._hScroller.pageCount<t._hScroller.count){if(l.deltaY>0){t.scrollPanel.scrollLeft+=t._lineHeight}else{t.scrollPanel.scrollLeft-=t._lineHeight}}}}}});t.scrollPanel.onscroll=function(l){if(t.refreshCancel){return}if(t._isVScroll){if(t._vScroller!=null){if(t._vScroller.pageCount<t._vScroller.count){t._vScroller.value=t.scrollPanel.scrollTop/t._lineHeight}}}if(t._isHScroll){if(t._hScroller!=null){if(t._hScroller.pageCount<t._hScroller.count){t._hScroller.value=t.scrollPanel.scrollLeft/t._lineHeight}}}};return t}Object.defineProperty(r.prototype,"vScroller",{get:function(){return this._vScroller},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"hScroller",{get:function(){return this._hScroller},enumerable:true,configurable:true});r.prototype.refresh=function(){var l=this;if(this._myTimeHaneld==-1){this._myTimeHaneld=setInterval(function(){clearInterval(l._myTimeHaneld);l._myTimeHaneld=-1;l.refreshFunction()},1)}};r.prototype.refreshFunction=function(){var e=this;if(this.refreshCancel){return}var l=this.scrollPanel.clientWidth/this._lineHeight;var t=this.panel.clientWidth/this._lineHeight;var r=this.scrollPanel.clientHeight/this._lineHeight;var i=this.panel.clientHeight/this._lineHeight;if(r<i&&this._isVScroll){this.scrollPanel.style.right="18px";if(this._hScroller!=null&&this.isHScroll){if(this._hScroller.right!=18){this._hScroller.right=18;this.refresh()}}if(this._vScroller==null&&this.isVScroll){this._vScroller=new o.Scroller;this._vScroller.top=0;this._vScroller.bottom=0;this._vScroller.right=0;this._vScroller.width=17;s.Util.appendDisplayObject(this.element,this._vScroller);this._vScroller.addEventListener(n.FXScrollEvent.Scroll,function(l){e.scrollPanel.scrollTop=l.value*e._lineHeight;e.dispatchEvent(l)})}}else{this.scrollPanel.style.right="0px";if(this._hScroller!=null&&this.isHScroll){if(this._hScroller.right!=0){this._hScroller.right=0;this.refresh()}}}if(l<t&&this._isHScroll){this.scrollPanel.style.bottom="18px";if(this._vScroller!=null&&this.isVScroll){if(this._vScroller.bottom!=18){this._vScroller.bottom=18;this._vScroller.value=0;this.refresh()}}if(this._hScroller==null&&this.isHScroll){this._hScroller=new o.Scroller(false);this._hScroller.left=0;this._hScroller.bottom=0;this._hScroller.right=0;this._hScroller.height=17;s.Util.appendDisplayObject(this.element,this._hScroller);this._hScroller.addEventListener(n.FXScrollEvent.Scroll,function(l){e.scrollPanel.scrollLeft=l.value*e._lineHeight;e.dispatchEvent(l)})}}else{this.scrollPanel.style.bottom="0px";if(this._vScroller!=null&&this.isVScroll){if(this._vScroller.bottom!=0){this._vScroller.bottom=0;this.refresh()}}}if(this._vScroller!=null&&this.isVScroll){this._vScroller.count=i;this._vScroller.pageCount=r;this._vScroller.value=this._vScroller.value}if(this._hScroller!=null&&this.isHScroll){this._hScroller.count=t;this._hScroller.pageCount=l;this._hScroller.value=this._hScroller.value}};r.prototype.addChild=function(l){e.prototype.addChild.call(this,l);this.refresh()};r.prototype.removeChild=function(l){e.prototype.removeChild.call(this,l);this.refresh()};Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(l){if(this._lineHeight!=l){this._lineHeight=l;this.refresh()}},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"isHScroll",{get:function(){return this._isHScroll},set:function(l){if(this._isHScroll!=l){this._isHScroll=l;this.refresh()}},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"isVScroll",{get:function(){return this._isVScroll},set:function(l){if(this._isVScroll!=l){this._isVScroll=l;this.refresh()}},enumerable:true,configurable:true});r.isCSSLoaded=false;return r}(t.Panel);e.ScrollPanel=r});